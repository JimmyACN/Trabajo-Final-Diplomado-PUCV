---
title: "Jimmy_Carrillo_Trabajo_Final"
author: "Jimmy Carrillo Novoa"
date: "14/7/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Librerias 
```{r}
library(readxl)
library(ggplot2)
library(dplyr)
library(multcomp)
library(psych)
library(car)
library(nlme)
library(lme4)
library(readr)
library(lmtest)
library(boot)
```


##Exploratorio del Set de Datos

```{r}
light <- read_excel("Light_intensity.xlsx")
```

```{r}
str(light)
```

## Ajuste de la variable Module

```{r}
light$Module <- as.factor(light$Module)
light$Volume_m3 <- as.factor(light$Volume_m3)
str(light)
```

## Resumen estadistico de la variables

```{r}
summary(light)
```

## Exploratorio de las variables.

## Intensidad de luz- watt/sqr 2 en Modulo A y Modulo B

```{r}
ggplot(data = light,aes(x= Module, y = watt_sq2, fill=Module)) +
  geom_boxplot() + theme(legend.position = 'right')

```


```{r}
p <- ggplot(data = light,aes(x = Module, y = watt_sq2))
p + geom_point(aes(colour = Volume_m3)) + stat_smooth(se = FALSE)
```

## Histograma de la variable respuesta light

```{r}
ggplot(light, aes(x=watt_sq2))+
  geom_histogram(color="darkblue", fill="red")
```


## Variable respuesta light

```{r}
ggplot(data = light, aes(x = watt_sq2)) +
  geom_histogram(aes(y = ..density.., fill = ..count..)) +
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C") +
  # scale_fill_gradient(low = 1, high = 2) +
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(light$watt_sq2),
                            sd = sd(light$watt_sq2))) +
  ggtitle("Histograma de light + Curva normal teÃ³rica") +
  theme_bw()
```

## MODELOS LINEALES MIXTOS##

## Modelo de efectos fijos.

## Ajuste de un modelo de efectos fijos donde la variable respuesta es light intensity y como efectos fijos del modelo las variables Density y Volumen de estanque. Density y Volumen como variables predictoras.  


```{r}
mod.1 <- lm(watt_sq2 ~ Density + Volume_m3, data = light)

pander::pander(summary(mod.1), caption = "Modelo de efectos fijos de la variable respuesta light y la interaccion de las variable predictora Density mas volume_m3")
```
## Plot del modelo

```{r}
par(mfrow=c(2,2))
plot(mod.1)
```



## Modelo Integrado 1

```{r}
mod.1.int <- lm(watt_sq2 ~ Density:Volume_m3, data = light)

pander::pander(summary(mod.1.int), caption = "Modelo de efectos fijos de la variable respuesta light y el efecto de interaccion entre variable predictora Density y volume_m3")
```

## Plot del Modelo

```{r}
par(mfrow=c(2,2))
plot(mod.1.int)
```

## Modelo integrado 2
```{r}
mod.2.int <- lm(watt_sq2 ~ Density+Volume_m3+Density:Volume_m3, data = light)

pander::pander(summary(mod.1.int), caption = "Modelo de efectos fijos de la variable respuesta light y el efecto de interaccion de las variable predictora Density y volume_m3 mas el efecto entre Density y Volume_m3")
```
## Plot del modelo
```{r}
par(mfrow=c(2,2))
plot(mod.2.int)
```


## Test de normalidad para mod.2.int
```{r}
shapiro.test (residuals (mod.2.int))
```
## El valor de p-value es menor a 0.05 por lo tanto el modelo no presenta una distribucion normal.    


## MODELOS CON EFECTOS FIJOS Y ALEATORIOS

## Modelo con efectos aleatorios 1

```{r}
mod.A.1 <- lmer(watt_sq2 ~ Density + Volume_m3 + (1|Module), data = light)
summary(mod.A.1)
```

## Modelo de efectos aleatorios 2

```{r}
mod.A.2 <- lmer(watt_sq2 ~ Density+Volume_m3+Density:Volume_m3 + (1|Module), data = light)
summary(mod.A.2)
```

```{r}
anova(mod.A.1,mod.A.2)
```


  















